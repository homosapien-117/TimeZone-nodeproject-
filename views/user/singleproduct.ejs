<!DOCTYPE html>
<html class="no-js" lang="zxx">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <title>Watch shop | eCommers</title>
    <meta name="description" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- <link rel="manifest" href="site.webmanifest" /> -->
    <link
      rel="shortcut icon"
      type="image/x-icon"
      href="user_assets/img/favicon.ico"
    />

    <!-- CSS here -->
    <link rel="stylesheet" href="/user_assets/css/bootstrap.min.css" />
    <link rel="stylesheet" href="/user_assets/css/owl.carousel.min.css" />
    <link rel="stylesheet" href="/user_assets/css/flaticon.css" />
    <link rel="stylesheet" href="/user_assets/css/slicknav.css" />
    <link rel="stylesheet" href="/user_assets/css/animate.min.css" />
    <link rel="stylesheet" href="/user_assets/css/magnific-popup.css" />
    <link rel="stylesheet" href="/user_assets/css/fontawesome-all.min.css" />
    <link rel="stylesheet" href="/user_assets/css/themify-icons.css" />
    <link rel="stylesheet" href="/user_assets/css/slick.css" />
    <link rel="stylesheet" href="/user_assets/css/nice-select.css" />
    <link rel="stylesheet" href="/user_assets/css/style.css" />

    <style>
      .user-ratings-section {
        max-width: 600px;
        margin: 0 auto;
      }

      .user-rating {
        background-color: #f9f9f9;
        border: 1px solid #ddd;
        padding: 10px;
        margin-bottom: 20px;
        border-radius: 5px;
      }

      .user-name {
        font-weight: bold;
        margin-bottom: 5px;
      }

      .rating {
        color: #ffc107; /* Star color */
        margin-bottom: 10px;
      }

      .review {
        margin-bottom: 0;
      }

      hr {
        border: 0.5px solid #ddd;
      }
      .rating-container {
        font-weight: 700;
        border: 1px solid #efeeee;
        border-radius: 8px;
        padding-left: 3px;
        padding-right: 3px;
      }
    </style>
  </head>

  <body>
    <header>
      <!-- Header Start -->
      <div class="header-area">
        <div class="main-header header-sticky">
          <div class="container-fluid">
            <div class="menu-wrapper">
              <!-- Logo -->
              <div class="logo">
                <a href="index.html"
                  ><img src="user_assets/img/logo/logo.png" alt=""
                /></a>
              </div>
              <!-- Main-menu -->
              <div class="main-menu d-none d-lg-block">
                <nav>
                  <ul id="navigation">
                    <li><a href="/">Home</a></li>

                    <!-- <li><a href="about.html">about</a></li> -->
                    <li class="hot">
                      <a href="/shop">shop</a>
                    </li>
                    <li>
                      <a href="#">Category</a>
                      <ul class="submenu">
                        <% categories.filter(category => category.status !==
                        false).forEach(category => { %>
                        <a
                          class="dropdown-item"
                          href="/shop?category=<%= category._id %>"
                        >
                          <%= category.name %>
                        </a>
                        <% }); %>
                      </ul>
                    </li>
                    <li><a href="contact.html">Contact</a></li>
                  </ul>
                </nav>
              </div>
              <!-- Header Right -->
              <div class="header-right">
                <ul>
                  <li>
                    <div class="search-bar">
                      <form action="/searchProducts" method="post">
                        <input
                          name="searchProducts"
                          type="text"
                          class="search-input"
                          placeholder="Search..."
                        />
                        <button class="search-button">
                          <img
                            src="/user_assets/img/adapt_icon/search-50.png"
                            style="height: 20px"
                          />
                        </button>
                      </form>
                    </div>
                  </li>
                  <li>
                    <a href="/profile"><span class="flaticon-user"></span></a>
                  </li>
                  <li>
                    <a href="/favouritespage">
                      <span class="flaticon-heart"></span
                    ></a>
                  </li>
                  <li>
                    <a href="/cartpage"
                      ><span class="flaticon-shopping-cart"></span
                    ></a>
                  </li>
                </ul>
              </div>
            </div>
            <!-- Mobile Menu -->
            <div class="col-12">
              <div class="mobile_menu d-block d-lg-none"></div>
            </div>
          </div>
        </div>
      </div>
      <!-- Header End -->

      <div class="fulldiv my-5 d-flex justify-content-center">
        <div class="product-container">
          <div class="product-image">
            <% product.images.forEach(image => { %>
            <a
              href="/<%= image %>"
              class="MagicZoom"
              id="Mag"
              data-options="zoomMode: 'zoom', variableZoom: true"
            >
              <img
                src="/<%= image %>"
                alt="Product Image"
                class="img-fluid"
                style="width: 300px; height: 300px; object-fit: cover"
              />
            </a>
            <% }); %>
          </div>
        </div>

        <!-- Product Details Section -->
        <div class="product-details-section">
          <h1><%= product.name %></h1>
          <p class="col-12 d-flex justify-content-end">
            <% if (product.userRatings && product.userRatings.length > 0) { %>
            <span id="ratingContainer" class="rating-container">
              ★&nbsp;<span id="avgrating"><%= averageRating %> </span
              >&nbsp;<span>(<%= totalRatings %>)</span>
            </span>
            <% } else { %>
          </p>

          <p>No ratings yet</p>
          <% } %>
          <p class="price">RS.<%= product.price.toFixed(2) %></p>

          <div class="description">
            <p><strong>Description:</strong></p>
            <p><%= product.description %></p>
          </div>
          <a href="/addtocart/<%= product._id %>" class="btn btn-primary"
            >Add to Cart</a
          >
          <a href="/addtofavourites/<%=product._id%>"
            ><button class="btn btn-secondary" style="height: 50px">
              <span class="fas fa-heart"></span> Add to Wishlist
            </button></a
          >
        </div>
      </div>

      <div class="container mt-3">
        <button
          style="margin-left: 30vw; margin-bottom: 1.5vw"
          id="toggleRatingsBtn"
          class="ml-5 btn btn-primary"
        >
          User Ratings and Reviews
        </button>

        <div
          class="user-ratings-section"
          id="ratingsSection"
          style="display: none"
        >
          <div class="row">
            <% if (locals.product.userRatings && product.userRatings.length > 0)
            { %> <% product.userRatings.forEach(userRating => { %>
            <div class="col-md-4 col-lg-6">
              <div class="user-rating">
                <p class="user-name">
                  <strong>User:</strong> <%= userRating.userId.username %>
                </p>
                <div class="rating">
                  <p>
                    <strong>Rating:</strong> <%= userRating.rating %> <%=
                    '★'.repeat(Math.floor(userRating.rating)) +
                    (userRating.rating % 1 !== 0 ? '½' : '') %>
                  </p>
                </div>
                <p class="review">
                  <strong>Review:</strong> <%= userRating.review %>
                </p>
                <hr />
              </div>
            </div>
            <% }); %> <% } else { %>
            <p>No ratings yet</p>

            <% } %>
          </div>
        </div>
      </div>

      <div class="container">
        <div class="row">
          <% if (locals.similar && locals.similar.length > 0) { %>
          <div class="similar-products-section ml-3 mt-5">
            <h1 style="text-align: center; margin-bottom: 30px">
              Similar Products
            </h1>
            <div class="row similar-products-container">
              <% locals.similar.forEach(product => { %>
              <div class="col-12 col-md-4 col-lg-3 mb-4 product-item">
                <a
                  class="product-item"
                  href="/singleproduct/<%= product._id %>"
                  data-types="<%= product.type %>"
                >
                  <div class="card fixed-card-size">
                    <img
                      src="/<%= product.images[0] %>"
                      class="card-img-top img-fluid product-thumbnail"
                      alt="<%= product.name %>"
                      style="height: 200px; object-fit: cover"
                    />
                    <div class="card-body" style="height: 200px; width: 500px">
                      <h3 class="card-title product-title">
                        <%= product.name %>
                      </h3>
                      <p class="card-text product-price">
                        ₹<%= product.price.toFixed(2) %>
                      </p>
                      <a
                        href="/singleproduct/<%= product._id %>"
                        class="btn btn-primary"
                        >View Details</a
                      >
                    </div>
                  </div>
                </a>
              </div>
              <% }); %>
            </div>
          </div>
          <% } %>
        </div>
      </div>

      <footer>
        <!-- Footer Start-->
        <div class="footer-area footer-padding">
          <div class="container">
            <div class="row d-flex justify-content-between">
              <div class="col-xl-3 col-lg-3 col-md-5 col-sm-6">
                <div class="single-footer-caption mb-50">
                  <div class="single-footer-caption mb-30">
                    <!-- logo -->
                    <div class="footer-logo">
                      <a href="index.html"
                        ><img
                          src="user_assets/img/logo/logo2_footer.png"
                          alt=""
                      /></a>
                    </div>
                    <div class="footer-tittle">
                      <div class="footer-pera">
                        <p>
                          Asorem ipsum adipolor sdit amet, consectetur
                          adipisicing elitcf sed do eiusmod tem.
                        </p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-xl-2 col-lg-3 col-md-3 col-sm-5">
                <div class="single-footer-caption mb-50">
                  <div class="footer-tittle">
                    <h4>Quick Links</h4>
                    <ul>
                      <li><a href="#">About</a></li>
                      <li><a href="#"> Offers & Discounts</a></li>
                      <li><a href="#"> Get Coupon</a></li>
                      <li><a href="#"> Contact Us</a></li>
                    </ul>
                  </div>
                </div>
              </div>
              <div class="col-xl-3 col-lg-3 col-md-4 col-sm-7">
                <div class="single-footer-caption mb-50">
                  <div class="footer-tittle">
                    <h4>New Products</h4>
                    <ul>
                      <li><a href="#">Woman Cloth</a></li>
                      <li><a href="#">Fashion Accessories</a></li>
                      <li><a href="#"> Man Accessories</a></li>
                      <li><a href="#"> Rubber made Toys</a></li>
                    </ul>
                  </div>
                </div>
              </div>
              <div class="col-xl-3 col-lg-3 col-md-5 col-sm-7">
                <div class="single-footer-caption mb-50">
                  <div class="footer-tittle">
                    <h4>Support</h4>
                    <ul>
                      <li><a href="#">Frequently Asked Questions</a></li>
                      <li><a href="#">Terms & Conditions</a></li>
                      <li><a href="#">Privacy Policy</a></li>
                      <li><a href="#">Report a Payment Issue</a></li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
            <!-- Footer bottom -->
            <div class="row align-items-center">
              <div class="col-xl-7 col-lg-8 col-md-7">
                <div class="footer-copy-right">
                  <p>
                    Copyright &copy;
                    <script>
                      document.write(new Date().getFullYear());
                    </script>
                    All rights reserved | This template is made with
                    <i class="fa fa-heart" aria-hidden="true"></i> by
                    <a href="https://colorlib.com" target="_blank">Colorlib</a>
                  </p>
                </div>
              </div>
              <div class="col-xl-5 col-lg-4 col-md-5">
                <div class="footer-copy-right f-right">
                  <!-- social -->
                  <div class="footer-social">
                    <a href="https://www.twiiter.com"
                      ><i class="fab fa-twitter"></i
                    ></a>
                    <a href="https://www.facebook.com/"
                      ><i class="fab fa-facebook-f"></i
                    ></a>
                    <a href="https://www.instagram.com"
                      ><i class="fab fa-instagram"></i
                    ></a>
                    <a href="#"><i class="fas fa-globe"></i></a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- Footer End-->
      </footer>
      <!--? Search model Begin -->
      <div class="search-model-box">
        <div class="h-100 d-flex align-items-center justify-content-center">
          <div class="search-close-btn">+</div>
          <form class="search-model-form">
            <input
              type="text"
              id="search-input"
              placeholder="Searching key....."
            />
          </form>
        </div>
      </div>
      <!-- Search model end -->

      <!-- JS here -->

      <script src="./user_assets/js/vendor/modernizr-3.5.0.min.js"></script>
      <!-- Jquery, Popper, Bootstrap -->
      <script src="./user_assets/js/vendor/jquery-1.12.4.min.js"></script>
      <script src="./user_assets/js/popper.min.js"></script>
      <script src="./user_assets/js/bootstrap.min.js"></script>
      <!-- Jquery Mobile Menu -->
      <script src="./user_assets/js/jquery.slicknav.min.js"></script>

      <!-- Jquery Slick , Owl-Carousel Plugins -->
      <script src="./user_assets/js/owl.carousel.min.js"></script>
      <script src="./user_assets/js/slick.min.js"></script>

      <!-- One Page, Animated-HeadLin -->
      <script src="./user_assets/js/wow.min.js"></script>
      <script src="./user_assets/js/animated.headline.js"></script>
      <script src="./user_assets/js/jquery.magnific-popup.js"></script>

      <!-- Scrollup, nice-select, sticky -->
      <script src="./user_assets/js/jquery.scrollUp.min.js"></script>
      <script src="./user_assets/js/jquery.nice-select.min.js"></script>
      <script src="./user_assets/js/jquery.sticky.js"></script>

      <!-- contact js -->
      <script src="./user_assets/js/contact.js"></script>
      <script src="./user_assets/js/jquery.form.js"></script>
      <script src="./user_assets/js/jquery.validate.min.js"></script>
      <script src="./user_assets/js/mail-script.js"></script>
      <script src="./user_assets/js/jquery.ajaxchimp.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/jquery.magnific-popup.min.js"></script>
      <link
        rel="stylesheet"
        type="text/css"
        href="/user_assets/css/magiczoomplus.css"
      />
      <script
        type="text/javascript"
        src="/user_assets/js/magiczoomplus.js"
      ></script>
      <script>
        // Initialize Magic Zoom Plus
        $(document).ready(function () {
          MagicZoomPlus.start();
        });
      </script>
      <script>
        var ratingsSection = document.getElementById("ratingsSection");
        var toggleRatingsBtn = document.getElementById("toggleRatingsBtn");

        toggleRatingsBtn.addEventListener("click", function () {
          if (ratingsSection.style.display === "none") {
            ratingsSection.style.display = "block";
          } else {
            ratingsSection.style.display = "none";
          }
        });
      </script>

      <script>
        const aveRating = parseFloat(
          document.getElementById("avgrating").innerText
        );

        console.log(aveRating);

        const ratingContainer = document.getElementById("ratingContainer");

        if (aveRating >= 4) {
          ratingContainer.style.backgroundColor = "green";
          ratingContainer.style.color = "white";
        } else if (aveRating >= 3 && aveRating <= 3.9) {
          ratingContainer.style.backgroundColor = "yellow";
        } else if (aveRating >= 2 && aveRating <= 2.9) {
          ratingContainer.style.backgroundColor = "orange";
        } else if (aveRating >= 0 && aveRating <= 1.9) {
          ratingContainer.style.backgroundColor = "red";
          ratingContainer.style.color = "white";
        }
      </script>
    </header>
  </body>
</html>
